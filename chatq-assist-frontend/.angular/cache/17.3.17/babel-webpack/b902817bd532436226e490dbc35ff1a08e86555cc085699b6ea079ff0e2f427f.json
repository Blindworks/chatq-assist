{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { catchError, throwError } from 'rxjs';\nimport { AuthService } from '../services/auth.service';\nexport const authInterceptor = (req, next) => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  // Get the auth token from the service\n  const token = authService.getToken();\n  console.log('Functional Interceptor - Token from storage:', token ? 'exists' : 'missing');\n  console.log('Functional Interceptor - Request URL:', req.url);\n  // Clone the request and add the authorization header if token exists\n  let authReq = req;\n  if (token) {\n    authReq = req.clone({\n      setHeaders: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    console.log('Functional Interceptor - Added Authorization header');\n  } else {\n    console.warn('Functional Interceptor - No token found, request will be sent without auth');\n  }\n  // Handle the request and catch errors\n  return next(authReq).pipe(catchError(error => {\n    if (error.status === 401) {\n      // Unauthorized - token might be expired or invalid\n      console.warn('Unauthorized request, logging out');\n      authService.logout();\n      router.navigate(['/login']);\n    }\n    return throwError(() => error);\n  }));\n};","map":{"version":3,"names":["inject","Router","catchError","throwError","AuthService","authInterceptor","req","next","authService","router","token","getToken","console","log","url","authReq","clone","setHeaders","Authorization","warn","pipe","error","status","logout","navigate"],"sources":["C:\\Users\\bened\\IdeaProjects\\ChatQ-Assist\\chatq-assist-frontend\\src\\app\\interceptors\\auth.interceptor.func.ts"],"sourcesContent":["import { HttpInterceptorFn, HttpErrorResponse } from '@angular/common/http';\nimport { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { catchError, throwError } from 'rxjs';\nimport { AuthService } from '../services/auth.service';\n\nexport const authInterceptor: HttpInterceptorFn = (req, next) => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n\n  // Get the auth token from the service\n  const token = authService.getToken();\n  console.log('Functional Interceptor - Token from storage:', token ? 'exists' : 'missing');\n  console.log('Functional Interceptor - Request URL:', req.url);\n\n  // Clone the request and add the authorization header if token exists\n  let authReq = req;\n  if (token) {\n    authReq = req.clone({\n      setHeaders: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    console.log('Functional Interceptor - Added Authorization header');\n  } else {\n    console.warn('Functional Interceptor - No token found, request will be sent without auth');\n  }\n\n  // Handle the request and catch errors\n  return next(authReq).pipe(\n    catchError((error: HttpErrorResponse) => {\n      if (error.status === 401) {\n        // Unauthorized - token might be expired or invalid\n        console.warn('Unauthorized request, logging out');\n        authService.logout();\n        router.navigate(['/login']);\n      }\n      return throwError(() => error);\n    })\n  );\n};\n"],"mappings":"AACA,SAASA,MAAM,QAAQ,eAAe;AACtC,SAASC,MAAM,QAAQ,iBAAiB;AACxC,SAASC,UAAU,EAAEC,UAAU,QAAQ,MAAM;AAC7C,SAASC,WAAW,QAAQ,0BAA0B;AAEtD,OAAO,MAAMC,eAAe,GAAsBA,CAACC,GAAG,EAAEC,IAAI,KAAI;EAC9D,MAAMC,WAAW,GAAGR,MAAM,CAACI,WAAW,CAAC;EACvC,MAAMK,MAAM,GAAGT,MAAM,CAACC,MAAM,CAAC;EAE7B;EACA,MAAMS,KAAK,GAAGF,WAAW,CAACG,QAAQ,EAAE;EACpCC,OAAO,CAACC,GAAG,CAAC,8CAA8C,EAAEH,KAAK,GAAG,QAAQ,GAAG,SAAS,CAAC;EACzFE,OAAO,CAACC,GAAG,CAAC,uCAAuC,EAAEP,GAAG,CAACQ,GAAG,CAAC;EAE7D;EACA,IAAIC,OAAO,GAAGT,GAAG;EACjB,IAAII,KAAK,EAAE;IACTK,OAAO,GAAGT,GAAG,CAACU,KAAK,CAAC;MAClBC,UAAU,EAAE;QACVC,aAAa,EAAE,UAAUR,KAAK;;KAEjC,CAAC;IACFE,OAAO,CAACC,GAAG,CAAC,qDAAqD,CAAC;GACnE,MAAM;IACLD,OAAO,CAACO,IAAI,CAAC,4EAA4E,CAAC;;EAG5F;EACA,OAAOZ,IAAI,CAACQ,OAAO,CAAC,CAACK,IAAI,CACvBlB,UAAU,CAAEmB,KAAwB,IAAI;IACtC,IAAIA,KAAK,CAACC,MAAM,KAAK,GAAG,EAAE;MACxB;MACAV,OAAO,CAACO,IAAI,CAAC,mCAAmC,CAAC;MACjDX,WAAW,CAACe,MAAM,EAAE;MACpBd,MAAM,CAACe,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;;IAE7B,OAAOrB,UAAU,CAAC,MAAMkB,KAAK,CAAC;EAChC,CAAC,CAAC,CACH;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}